<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ø¸Ø§Ù…</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-8">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-3xl font-bold text-center mb-8">ğŸ§ª Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ø¸Ø§Ù…</h1>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Ø§Ø®ØªØ¨Ø§Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„ÙØ§Øª -->
            <div class="bg-white p-6 rounded-lg shadow">
                <h2 class="text-xl font-bold mb-4">ğŸ“ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„ÙØ§Øª</h2>
                <div id="fileTests" class="space-y-2">
                    <div class="flex items-center">
                        <span class="w-4 h-4 rounded-full bg-gray-300 mr-2" id="supabaseLib"></span>
                        <span>Ù…ÙƒØªØ¨Ø© Supabase</span>
                    </div>
                    <div class="flex items-center">
                        <span class="w-4 h-4 rounded-full bg-gray-300 mr-2" id="supabaseConfig"></span>
                        <span>Ù…Ù„Ù supabase-config.js</span>
                    </div>
                    <div class="flex items-center">
                        <span class="w-4 h-4 rounded-full bg-gray-300 mr-2" id="supabaseIntegration"></span>
                        <span>Ù…Ù„Ù supabase-integration.js</span>
                    </div>
                    <div class="flex items-center">
                        <span class="w-4 h-4 rounded-full bg-gray-300 mr-2" id="appJs"></span>
                        <span>Ù…Ù„Ù app.js</span>
                    </div>
                </div>
            </div>

            <!-- Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ÙˆØ¸Ø§Ø¦Ù -->
            <div class="bg-white p-6 rounded-lg shadow">
                <h2 class="text-xl font-bold mb-4">âš™ï¸ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ÙˆØ¸Ø§Ø¦Ù</h2>
                <div id="functionTests" class="space-y-2">
                    <div class="flex items-center">
                        <span class="w-4 h-4 rounded-full bg-gray-300 mr-2" id="initSupabase"></span>
                        <span>ØªÙ‡ÙŠØ¦Ø© Supabase</span>
                    </div>
                    <div class="flex items-center">
                        <span class="w-4 h-4 rounded-full bg-gray-300 mr-2" id="loadLocalData"></span>
                        <span>ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©</span>
                    </div>
                    <div class="flex items-center">
                        <span class="w-4 h-4 rounded-full bg-gray-300 mr-2" id="initializeApp"></span>
                        <span>ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</span>
                    </div>
                </div>
            </div>

            <!-- Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± -->
            <div class="bg-white p-6 rounded-lg shadow md:col-span-2">
                <h2 class="text-xl font-bold mb-4">ğŸ“Š Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</h2>
                <div id="testResults" class="bg-gray-50 p-4 rounded text-sm font-mono">
                    Ø¬Ø§Ø±ÙŠ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª...
                </div>
            </div>
        </div>

        <div class="text-center mt-8">
            <button onclick="runTests()" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700">
                ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª
            </button>
            <a href="index.html" class="bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 mr-4">
                ğŸš€ ÙØªØ­ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
            </a>
        </div>
    </div>

    <!-- ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„ÙØ§Øª -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="supabase-config.js"></script>
    <script src="supabase-integration.js"></script>
    <script src="app.js"></script>

    <script>
        function setStatus(id, success, message = '') {
            const element = document.getElementById(id);
            if (success) {
                element.className = 'w-4 h-4 rounded-full bg-green-500 mr-2';
            } else {
                element.className = 'w-4 h-4 rounded-full bg-red-500 mr-2';
            }
        }

        function log(message) {
            const results = document.getElementById('testResults');
            results.innerHTML += message + '\n';
        }

        async function runTests() {
            document.getElementById('testResults').innerHTML = 'Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª...\n';
            
            // Ø§Ø®ØªØ¨Ø§Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„ÙØ§Øª
            log('ğŸ” Ø§Ø®ØªØ¨Ø§Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„ÙØ§Øª...');
            
            // Ù…ÙƒØªØ¨Ø© Supabase
            const supabaseLoaded = typeof window.supabase !== 'undefined';
            setStatus('supabaseLib', supabaseLoaded);
            log(`- Ù…ÙƒØªØ¨Ø© Supabase: ${supabaseLoaded ? 'âœ… Ù…Ø­Ù…Ù„Ø©' : 'âŒ ØºÙŠØ± Ù…Ø­Ù…Ù„Ø©'}`);

            // Ù…Ù„Ù supabase-config.js
            const configLoaded = typeof SUPABASE_URL !== 'undefined';
            setStatus('supabaseConfig', configLoaded);
            log(`- Ù…Ù„Ù supabase-config.js: ${configLoaded ? 'âœ… Ù…Ø­Ù…Ù„' : 'âŒ ØºÙŠØ± Ù…Ø­Ù…Ù„'}`);

            // Ù…Ù„Ù supabase-integration.js
            const integrationLoaded = typeof initSupabase !== 'undefined';
            setStatus('supabaseIntegration', integrationLoaded);
            log(`- Ù…Ù„Ù supabase-integration.js: ${integrationLoaded ? 'âœ… Ù…Ø­Ù…Ù„' : 'âŒ ØºÙŠØ± Ù…Ø­Ù…Ù„'}`);

            // Ù…Ù„Ù app.js
            const appLoaded = typeof AppData !== 'undefined';
            setStatus('appJs', appLoaded);
            log(`- Ù…Ù„Ù app.js: ${appLoaded ? 'âœ… Ù…Ø­Ù…Ù„' : 'âŒ ØºÙŠØ± Ù…Ø­Ù…Ù„'}`);

            // Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ÙˆØ¸Ø§Ø¦Ù
            log('\nâš™ï¸ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ÙˆØ¸Ø§Ø¦Ù...');

            // ØªÙ‡ÙŠØ¦Ø© Supabase
            try {
                if (typeof initSupabase !== 'undefined') {
                    const supabaseReady = await initSupabase();
                    setStatus('initSupabase', true);
                    log(`- ØªÙ‡ÙŠØ¦Ø© Supabase: âœ… ${supabaseReady ? 'Ø¬Ø§Ù‡Ø²' : 'ØºÙŠØ± Ù…ÙØ¹Ø¯ (Ø³ÙŠØ¹Ù…Ù„ Ù…Ø­Ù„ÙŠØ§Ù‹)'}`);
                } else {
                    setStatus('initSupabase', false);
                    log('- ØªÙ‡ÙŠØ¦Ø© Supabase: âŒ Ø§Ù„ÙˆØ¸ÙŠÙØ© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©');
                }
            } catch (error) {
                setStatus('initSupabase', false);
                log(`- ØªÙ‡ÙŠØ¦Ø© Supabase: âŒ Ø®Ø·Ø£ - ${error.message}`);
            }

            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©
            try {
                if (typeof loadLocalData !== 'undefined') {
                    loadLocalData();
                    setStatus('loadLocalData', true);
                    log('- ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©: âœ… Ù†Ø¬Ø­');
                } else {
                    // Ø§Ø³ØªØ®Ø¯Ø§Ù… loadData Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø°Ù„Ùƒ
                    loadData();
                    setStatus('loadLocalData', true);
                    log('- ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©: âœ… Ù†Ø¬Ø­ (loadData)');
                }
            } catch (error) {
                setStatus('loadLocalData', false);
                log(`- ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©: âŒ Ø®Ø·Ø£ - ${error.message}`);
            }

            // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
            try {
                if (typeof initializeApp !== 'undefined') {
                    initializeApp();
                    setStatus('initializeApp', true);
                    log('- ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚: âœ… Ù†Ø¬Ø­');
                } else {
                    setStatus('initializeApp', false);
                    log('- ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚: âŒ Ø§Ù„ÙˆØ¸ÙŠÙØ© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©');
                }
            } catch (error) {
                setStatus('initializeApp', false);
                log(`- ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚: âŒ Ø®Ø·Ø£ - ${error.message}`);
            }

            log('\nğŸ‰ Ø§Ù†ØªÙ‡Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª!');
            log(`ğŸ“Š Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©:`);
            log(`   - Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª: ${AppData.cars.length}`);
            log(`   - Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†: ${AppData.employees.length}`);
            log(`   - Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª: ${AppData.expenses.length}`);
            log(`   - Ø±ØµÙŠØ¯ Ø§Ù„Ø®Ø²ÙŠÙ†Ø©: ${AppData.treasury.balance}`);
        }

        // ØªØ´ØºÙŠÙ„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        document.addEventListener('DOMContentLoaded', runTests);
    </script>
</body>
</html>
