# دليل التخزين والمرفقات - نظام إدارة مصروفات السيارات

## 📁 تخزين البيانات

### 🔍 مكان التخزين
البيانات يتم تخزينها في **localStorage** الخاص بالمتصفح:

```
المسار التقني: localStorage['carExpenseApp']
الموقع الفعلي: 
- Windows: %LOCALAPPDATA%\Google\Chrome\User Data\Default\Local Storage
- macOS: ~/Library/Application Support/Google/Chrome/Default/Local Storage
- Linux: ~/.config/google-chrome/Default/Local Storage
```

### 📊 معلومات التخزين

#### الحد الأقصى للتخزين:
- **localStorage**: 5-10 ميجابايت (حسب المتصفح)
- **Chrome**: عادة 10 ميجابايت
- **Firefox**: عادة 10 ميجابايت
- **Safari**: عادة 5 ميجابايت

#### أنواع البيانات المحفوظة:
1. **بيانات السيارات** - معلومات الأسطول
2. **بيانات الموظفين** - معلومات الموظفين والسائقين
3. **المصروفات** - جميع المصروفات مع التفاصيل
4. **معاملات الخزينة** - المبالغ المستلمة والمنصرفة
5. **المرفقات** - الصور والملفات (Base64)
6. **التحليلات الذكية** - تقارير الذكاء الاصطناعي
7. **الإعدادات** - تفضيلات المستخدم

---

## 📎 نظام المرفقات

### ✅ الميزات الحالية

#### أنواع الملفات المدعومة:
- **الصور**: JPG, JPEG, PNG, GIF
- **المستندات**: PDF, DOC, DOCX
- **الحد الأقصى**: 5 ميجابايت لكل ملف

#### طرق رفع المرفقات:
1. **السحب والإفلات** (Drag & Drop)
   - اسحب الملف إلى المنطقة المخصصة
   - يتم التحقق من النوع والحجم تلقائياً

2. **النقر والاختيار**
   - انقر على منطقة الرفع
   - اختر الملف من نافذة الاستعراض

3. **التحقق التلقائي**
   - فحص نوع الملف
   - فحص حجم الملف
   - عرض رسائل خطأ واضحة

#### تخزين المرفقات:
- **التنسيق**: Base64 encoding
- **الموقع**: داخل كائن المصروف
- **المعلومات المحفوظة**:
  - اسم الملف
  - نوع الملف
  - حجم الملف
  - البيانات المشفرة

### 🔧 إدارة المرفقات

#### عرض المرفقات:
- **في قائمة المصروفات**: أيقونة مرفق
- **عند النقر**: عرض الصورة أو معلومات الملف
- **تحميل**: إمكانية حفظ الملف على الجهاز

#### تحسين الأداء:
- **ضغط الصور**: يُنصح بضغط الصور قبل الرفع
- **تنظيف دوري**: حذف المرفقات القديمة
- **نسخ احتياطية**: حفظ المرفقات خارجياً

---

## ⚙️ إدارة مساحة التخزين

### 📈 مراقبة الاستخدام

#### في الإعدادات المتقدمة:
- **حجم البيانات الإجمالي**
- **عدد المرفقات**
- **حجم المرفقات**
- **نسبة الاستخدام**

#### تنبيهات تلقائية:
- **60%**: تنبيه أصفر
- **80%**: تحذير أحمر
- **90%**: خطر امتلاء التخزين

### 🧹 تنظيف البيانات

#### تنظيف المرفقات القديمة:
```javascript
// تلقائياً: حذف مرفقات أقدم من 6 أشهر
cleanupOldAttachments()
```

#### نصائح لتوفير المساحة:
1. **ضغط الصور** قبل الرفع
2. **استخدام PDF** بدلاً من صور متعددة
3. **حذف المرفقات** غير الضرورية
4. **نسخ احتياطية دورية** مع مسح البيانات القديمة

---

## 🔒 الأمان والحماية

### 🛡️ أمان البيانات

#### الحماية المحلية:
- **لا إرسال خارجي**: البيانات لا تغادر الجهاز
- **تشفير localStorage**: حماية أساسية من المتصفح
- **عدم الوصول عبر الإنترنت**: لا يمكن الوصول للبيانات من خوادج خارجية

#### المخاطر المحتملة:
- **مسح بيانات المتصفح**: فقدان جميع البيانات
- **تلف المتصفح**: عدم إمكانية الوصول للبيانات
- **فيروسات**: قد تؤثر على ملفات المتصفح

### 💾 النسخ الاحتياطية

#### أنواع النسخ الاحتياطية:
1. **نسخة كاملة** (JSON): جميع البيانات مع المرفقات
2. **نسخة أساسية** (JSON): البيانات بدون المرفقات
3. **تصدير Excel**: البيانات في جداول منفصلة

#### جدولة النسخ الاحتياطية:
- **يومياً**: للاستخدام المكثف
- **أسبوعياً**: للاستخدام العادي
- **شهرياً**: للاستخدام الخفيف

---

## 🚀 تحسينات مستقبلية

### 📱 تخزين سحابي (مقترح)
- **Google Drive API**: تزامن تلقائي
- **Dropbox API**: نسخ احتياطية سحابية
- **OneDrive API**: تكامل مع Microsoft

### 🗄️ قاعدة بيانات محلية (مقترح)
- **IndexedDB**: تخزين أكبر وأسرع
- **WebSQL**: دعم استعلامات SQL
- **Dexie.js**: مكتبة محسنة لـ IndexedDB

### 🔄 تزامن متعدد الأجهزة (مقترح)
- **WebRTC**: تزامن مباشر بين الأجهزة
- **Firebase**: قاعدة بيانات سحابية
- **Socket.io**: تحديثات فورية

---

## 🛠️ استكشاف الأخطاء

### ❌ مشاكل شائعة

#### "مساحة التخزين ممتلئة":
1. احذف المرفقات القديمة
2. أنشئ نسخة احتياطية
3. امسح البيانات القديمة
4. استخدم متصفح آخر مؤقتاً

#### "فشل في حفظ البيانات":
1. تحقق من مساحة القرص الصلب
2. أعد تشغيل المتصفح
3. امسح ذاكرة التخزين المؤقت
4. جرب الوضع الخاص (Incognito)

#### "المرفق لا يظهر":
1. تحقق من نوع الملف المدعوم
2. تأكد من حجم الملف (أقل من 5 ميجا)
3. جرب ملف آخر
4. أعد تحميل الصفحة

### 🔧 حلول متقدمة

#### استرداد البيانات:
```javascript
// استرداد من النسخة الاحتياطية التلقائية
localStorage.getItem('carExpenseApp_backup')

// استرداد من النسخة الطارئة
localStorage.getItem('carExpenseApp_emergency')
```

#### تصدير البيانات يدوياً:
```javascript
// في وحدة تحكم المتصفح (F12)
console.log(JSON.stringify(JSON.parse(localStorage.getItem('carExpenseApp')), null, 2))
```

---

## 📞 الدعم الفني

### للمساعدة في مشاكل التخزين:
1. **اتبع خطوات استكشاف الأخطاء**
2. **أنشئ نسخة احتياطية فوراً**
3. **سجل رسائل الخطأ من وحدة التحكم**
4. **تواصل مع المطور مع التفاصيل**

---

**مطور النظام: محمد مبروك عطية**  
**Developer: Mohamed Mabrouk Attia**  
**نظام إدارة مصروفات السيارات - RASHID INDUSTRIAL CO.**
